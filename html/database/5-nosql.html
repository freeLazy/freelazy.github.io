<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2023-02-16 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NoSQL</title>
<meta name="author" content="1a2y" />
<meta name="generator" content="Org Mode" />
<link rel='stylesheet' href='/html/asset/common.css?3344' />
<link rel='stylesheet' href='/yaoliuyao/html/asset/common.css?3344' />
<script src='https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js'></script>
<script src='https://cdn.bootcss.com/bootstrap/3.3.4/js/bootstrap.min.js'></script>
<script src='/html/asset/common.js'></script>
<script src='/yaoliuyao/html/asset/common.js'></script>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">NoSQL</h1>
</header><nav id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org34307f1">1. NoSQL</a></li>
<li><a href="#orgd4c7b7f">2. MongoDB</a>
<ul>
<li><a href="#org31df017">2.1. 安装</a></li>
<li><a href="#orgfcdbdfb">2.2. 服务端</a></li>
<li><a href="#org7886cc8">2.3. 客户端 (mongosh)</a>
<ul>
<li><a href="#org3c85b2c">2.3.1. API Refs</a></li>
</ul>
</li>
<li><a href="#org864313b">2.4. 客户端 (.NET MongoDB.Driver)</a></li>
</ul>
</li>
<li><a href="#orga661eca">3. Redis</a>
<ul>
<li><a href="#org619b46b">3.1. 安装</a></li>
<li><a href="#org998bbb2">3.2. 服务端</a></li>
<li><a href="#orgb6b537b">3.3. 客户端 (redis-cli)</a></li>
<li><a href="#orga58eb2e">3.4. 客户端 (.NET)</a></li>
</ul>
</li>
</ul>
</div>
</nav>


<section id="outline-container-org34307f1" class="outline-2">
<h2 id="org34307f1"><span class="section-number-2">1.</span> NoSQL</h2>
<div class="outline-text-2" id="text-1">
<p>
名字解释:
</p>
<ol class="org-ol">
<li>No SQL，不是关系型数据库 (SQL, Sqeuence Query Language)</li>
<li>Not Only SQL, 不仅是关系型数据库</li>
</ol>

<p>
NoSQL 数据库:
</p>
<ul class="org-ul">
<li>Redis</li>
<li>MongoDB/CouchDB</li>
<li>HBase</li>
</ul>

<p>
对于数据库存储:
</p>
<ul class="org-ul">
<li>优先使用关系型数据库。一般情况下，已经完全满足需求了</li>
<li>当关系型数据库满足不了你的需求，你就可以寻求 NoSQL 的帮助了</li>
<li>当你有足够内存，并数据的 schema 不是非常确定，MongoDB 是你的最优解</li>
<li>当你追求的唯一是速度而不在乎数据的落地的话，那么 Redis 是那么美</li>
<li>当你有大量、巨量的数据，数据量已经成为了你最大的问题，那么你的选项只有 ElasticSearch/HBase</li>
</ul>

<p>
总之:
</p>
<ul class="org-ul">
<li>MongoDB 可以当做简单场景下的但是性能高数倍的 MySQL</li>
<li>Redis 最适合做缓存</li>
<li>HBase 擅长读写和做离线计算</li>
<li>ElasticSearch 更强于索引和检索</li>
</ul>
</div>
</section>

<section id="outline-container-orgd4c7b7f" class="outline-2">
<h2 id="orgd4c7b7f"><span class="section-number-2">2.</span> MongoDB</h2>
<div class="outline-text-2" id="text-2">
<p>
<a href="https://www.mongodb.com/">https://www.mongodb.com/</a>
</p>
</div>

<div id="outline-container-org31df017" class="outline-3">
<h3 id="org31df017"><span class="section-number-3">2.1.</span> 安装</h3>
<div class="outline-text-3" id="text-2-1">
<ul class="org-ul">
<li>服务端: <a href="https://www.mongodb.com/try/download/community">https://www.mongodb.com/try/download/community</a></li>
<li>客户端: <a href="https://www.mongodb.com/try/download/shell">https://www.mongodb.com/try/download/shell</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgfcdbdfb" class="outline-3">
<h3 id="orgfcdbdfb"><span class="section-number-3">2.2.</span> 服务端</h3>
<div class="outline-text-3" id="text-2-2">
<p>
如果你安装了服务，那么可以通过在 services.msc 中开启 MongoDb。或者通过命令行:
</p>
<pre class="example">
net start MongoDB
</pre>


<p>
如果你没安装服务，那么通过如下命令开启服务:
</p>
<pre class="example">
mongod --conf "e:\mongodb\mg.conf" --dbpath "e:\mongodb\data"
</pre>


<p>
因为 MongoDB 也是采取的 CS 模式，所以只有开启了服务端，才能正常使用。
</p>
</div>
</div>

<div id="outline-container-org7886cc8" class="outline-3">
<h3 id="org7886cc8"><span class="section-number-3">2.3.</span> 客户端 (mongosh)</h3>
<div class="outline-text-3" id="text-2-3">
<p>
客户端，可以安装使用 mongosh 或者安装使用图形界面版的 compass。
</p>

<p>
如果使用 mongosh，连接的话使用如下语法:
</p>
<pre class="example">
mongosh
mongosh --host 127.0.0.1 --port 27017
mongosh --host yaoqisan --port 27017
mongosh [options] [db address] [file names (ending in .js or .mongodb)]
</pre>


<p>
基本结构:
</p>
<pre class="example">
db
 - collection(表)
   - document(行)
</pre>


<p>
基本语法:
</p>
<div class="org-src-container">
<pre class="src src-javascript">db       <span style="color: #595959;">// </span><span style="color: #595959;">current working db</span>
use vip  <span style="color: #595959;">// </span><span style="color: #595959;">switch to db named 'vip'</span>

<span style="color: #595959;">// </span><span style="color: #595959;">help</span>
help
db.test.help<span style="color: #000000;">()</span>

<span style="color: #595959;">// </span><span style="color: #595959;">info</span>
show dbs
show collections <span style="color: #595959;">// </span><span style="color: #595959;">db.getCollectionNames(); show tables;</span>

<span style="color: #595959;">////// </span><span style="color: #595959;">DDL ///////</span>

<span style="color: #595959;">// </span><span style="color: #595959;">drop current db</span>
db.dropDatabase<span style="color: #000000;">()</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | create table users {...}</span>
db.createCollection<span style="color: #000000;">(</span><span style="color: #3548cf;">"users"</span><span style="color: #000000;">)</span>   <span style="color: #595959;">// </span><span style="color: #595959;">optional, can auto create when insert occured</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | create index</span>
db.users.createIndex<span style="color: #000000;">(</span><span style="color: #dd22dd;">{</span>user_id:1<span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span> <span style="color: #595959;">// </span><span style="color: #595959;">users is collections, just as table</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | drop table users</span>
db.users.drop<span style="color: #000000;">()</span>
db.collection.drop<span style="color: #000000;">()</span>

<span style="color: #595959;">////// </span><span style="color: #595959;">DML ///////</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | insert into users values {...}</span>
db.users.insert<span style="color: #000000;">(</span><span style="color: #dd22dd;">{</span>id:<span style="color: #3548cf;">"vip"</span>, age:20, stat:<span style="color: #3548cf;">"A"</span><span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | select * from users</span>
<span style="color: #595959;">// </span><span style="color: #595959;">as | select * from users limit 1</span>
db.users.find<span style="color: #000000;">()</span>
db.users.findOne<span style="color: #000000;">()</span>
db.users.find<span style="color: #000000;">()</span>.limit<span style="color: #000000;">(</span>1<span style="color: #000000;">)</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | select * from users where age &gt; 5</span>
<span style="color: #595959;">// </span><span style="color: #595959;">as | select * from users where stat='A' sort by user_id</span>
db.users.find<span style="color: #000000;">(</span><span style="color: #dd22dd;">{</span>age: <span style="color: #008899;">{</span>$gt: 25<span style="color: #008899;">}</span><span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span>
db.users.find<span style="color: #000000;">(</span><span style="color: #dd22dd;">{</span>stat: <span style="color: #3548cf;">'A'</span><span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span>.sort<span style="color: #000000;">(</span><span style="color: #3548cf;">'user_id'</span><span style="color: #000000;">)</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | select count(*) from users where age=18</span>
db.users.count<span style="color: #000000;">(</span><span style="color: #dd22dd;">{</span>age:18<span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | alter table users add column ... | update users set .. where age=18</span>
db.users.update<span style="color: #000000;">(</span><span style="color: #dd22dd;">{}</span>, <span style="color: #dd22dd;">{</span>$set:<span style="color: #008899;">{</span>join_date:newDate<span style="color: #972500;">()</span><span style="color: #008899;">}</span><span style="color: #dd22dd;">}</span>, <span style="color: #dd22dd;">{</span>multi:<span style="color: #0000b0;">true</span><span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span>
db.users.update<span style="color: #000000;">(</span><span style="color: #dd22dd;">{</span>age: 18<span style="color: #dd22dd;">}</span>, <span style="color: #dd22dd;">{</span>$set: <span style="color: #008899;">{</span>stat: <span style="color: #3548cf;">'X'</span><span style="color: #008899;">}</span><span style="color: #dd22dd;">}</span>, <span style="color: #dd22dd;">{</span>multi: <span style="color: #0000b0;">true</span><span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span>

<span style="color: #595959;">// </span><span style="color: #595959;">as | delete from users where stat='A'</span>
db.users.remove<span style="color: #000000;">(</span><span style="color: #dd22dd;">{</span>stat: <span style="color: #3548cf;">'A'</span><span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span>
</pre>
</div>
</div>

<div id="outline-container-org3c85b2c" class="outline-4">
<h4 id="org3c85b2c"><span class="section-number-4">2.3.1.</span> API Refs</h4>
<div class="outline-text-4" id="text-2-3-1">
<p>
Database API (db.xxx):
</p>
<pre class="example" id="org521fe0c">
adminCommand                               Runs an arbitrary command against the admin database.
aggregate                                  Runs a specified admin/diagnostic pipeline which does not require an underlying collection.
auth                                       Allows a user to authenticate to the database from within the shell.
changeUserPassword                         Updates a user’s password. Run the method in the database where the user is defined, i.e. the database you created the user.
cloneCollection                            deprecated, non-functional
cloneDatabase                              deprecated, non-functional
commandHelp                                returns the db commandHelp. uses the passed in command with help: true
copyDatabase                               deprecated, non-functional
createCollection                           Create new collection
createRole                                 Creates a new role.
createUser                                 Creates a new user for the database on which the method is run. db.createUser() returns a duplicate user error if the user already exists on the database.
createView                                 Create new view
currentOp                                  Runs an aggregation using $currentOp operator. Returns a document that contains information on in-progress operations for the database instance. For further information, see $currentOp.
disableFreeMonitoring                      returns the db disableFreeMonitoring. uses the setFreeMonitoring command
dropAllRoles                               Removes all roles from the current database.
dropAllUsers                               Removes all users from the current database.
dropDatabase                               Removes the current database, deleting the associated data files.
dropRole                                   Removes the role from the current database.
dropUser                                   Removes the user from the current database.
enableFreeMonitoring                       returns the db enableFreeMonitoring. uses the setFreeMonitoring command
fsyncLock                                  Calls the fsync command. Forces the mongod to flush all pending write operations to disk and locks the entire mongod instance to prevent additional writes until the user releases the lock with a corresponding db.fsyncUnlock() command.
fsyncUnlock                                Calls the fsyncUnlock command. Reduces the lock taken by db.fsyncLock() on a mongod instance by 1.
getCollection                              Returns a collection or a view object that is functionally equivalent to using the db.&lt;collectionName&gt;.
getCollectionInfos                         Returns an array of documents with collection information, i.e. collection name and options, for the current database.
getCollectionNames                         Returns an array containing the names of all collections in the current database.
getFreeMonitoringStatus                    Calls the getFreeMonitoringStatus command
getLastError                               Calls the getLastError command
getLastErrorObj                            Calls the getLastError command
getLogComponents                           returns the db getLogComponents. uses the getParameter command
getMongo                                   Returns the current database connection
getName                                    Returns the name of the DB
getProfilingStatus                         returns the db getProfilingStatus. uses the profile command
getReplicationInfo                         Returns replication information
getRole                                    Returns role information for a specified role. Run this method on the role’s database. The role must exist on the database on which the method runs.
getRoles                                   Returns information for all the roles in the database.
getSiblingDB                               Returns another database without modifying the db variable in the shell environment.
getUser                                    Returns user information for a specified user. Run this method on the user’s database. The user must exist on the database on which the method runs.
getUsers                                   Returns information for all the users in the database.
grantPrivilegesToRole                      Grants additional privileges to a role.
grantRolesToRole                           Grants additional roles to a role.
grantRolesToUser                           Grants additional roles to a user.
hello                                      Calls the hello command
hostInfo                                   Calls the hostInfo command
isMaster                                   Calls the isMaster command
killOp                                     Calls the killOp command. Terminates an operation as specified by the operation ID. To find operations and their corresponding IDs, see $currentOp or db.currentOp().
listCommands                               Calls the listCommands command
logout                                     Ends the current authentication session. This function has no effect if the current session is not authenticated.
printCollectionStats                       Prints the collection.stats for each collection in the db.
printReplicationInfo                       Formats sh.getReplicationInfo
printSecondaryReplicationInfo              Prints secondary replicaset information
printShardingStatus                        Calls sh.status(verbose)
printSlaveReplicationInfo                  DEPRECATED. Use db.printSecondaryReplicationInfo
revokePrivilegesFromRole                   Removes a one or more privileges from a role on the current database.
revokeRolesFromRole                        Removes a one or more roles from a role on the current database.
revokeRolesFromUser                        Removes a one or more roles from a user on the current database.
rotateCertificates                         Calls the rotateCertificates command
runCommand                                 Runs an arbitrary command on the database.
serverBits                                 returns the db serverBits. uses the buildInfo command
serverBuildInfo                            returns the db serverBuildInfo. uses the buildInfo command
serverCmdLineOpts                          returns the db serverCmdLineOpts. uses the getCmdLineOpts command
serverStatus                               returns the server stats. uses the serverStatus command
setLogLevel                                returns the db setLogLevel. uses the setParameter command
setProfilingLevel                          returns the db setProfilingLevel. uses the profile command
setSecondaryOk                             This method is deprecated. Use db.getMongo().setReadPref() instead
shutdownServer                             Calls the shutdown command. Shuts down the current mongod or mongos process cleanly and safely. You must issue the db.shutdownServer() operation against the admin database.
sql                                        (Experimental) Runs a SQL query against Atlas Data Lake. Note: this is an experimental feature that may be subject to change in future releases.
stats                                      returns the db stats. uses the dbStats command
updateRole                                 Updates the role’s profile on the database on which you run the method. An update to a field completely replaces the previous field’s values.
updateUser                                 Updates the user’s profile on the database on which you run the method. An update to a field completely replaces the previous field’s values. This includes updates to the user’s roles array.
version                                    returns the db version. uses the buildinfo command
watch                                      Opens a change stream cursor on the database
</pre>

<p>
Collection API (db.books.xxx):
</p>
<pre class="example" id="org6c7371a">
aggregate                                  Calculates aggregate values for the data in a collection or a view.
bulkWrite                                  Performs multiple write operations with controls for order of execution.
compactStructuredEncryptionData            Compacts structured encryption data
convertToCapped                            calls {convertToCapped:'coll', size:maxBytes}} command
count                                      Returns the count of documents that would match a find() query for the collection or view.
countDocuments                             Returns the count of documents that match the query for a collection or view.
createIndex                                Creates one index on a collection
createIndexes                              Creates one or more indexes on a collection
dataSize                                   This method provides a wrapper around the size output of the collStats (i.e. db.collection.stats()) command.
deleteMany                                 Removes all documents that match the filter from a collection.
deleteOne                                  Removes a single document from a collection.
distinct                                   Finds the distinct values for a specified field across a single collection or view and returns the results in an array.
drop                                       Removes a collection or view from the database.
dropIndex                                  Drops or removes the specified index from a collection.
dropIndexes                                Drops the specified index or indexes (except the index on the _id field) from a collection.
ensureIndex                                Creates one index on a collection
estimatedDocumentCount                     Returns the count of all documents in a collection or view.
exists                                     Returns collection infos if the collection exists or null otherwise.
explain                                    Returns information on the query plan.
find                                       Selects documents in a collection or view.
findAndModify                              Modifies and returns a single document.
findOne                                    Selects documents in a collection or view.
findOneAndDelete                           Deletes a single document based on the filter and sort criteria, returning the deleted document.
findOneAndReplace                          Modifies and replaces a single document based on the filter and sort criteria.
findOneAndUpdate                           Updates a single document based on the filter and sort criteria.
getDB                                      Get current database.
getFullName                                Returns the name of the collection prefixed with the database name.
getIndexKeys                               Return an array of key patterns for indexes defined on collection
getIndexSpecs                              Alias for getIndexes. Returns an array that holds a list of documents that identify and describe the existing indexes on the collection.
getIndexes                                 Returns an array that holds a list of documents that identify and describe the existing indexes on the collection.
getIndices                                 Alias for getIndexes. Returns an array that holds a list of documents that identify and describe the existing indexes on the collection.
getMongo                                   Returns the Mongo object.
getName                                    Returns the name of the collection.
getPlanCache                               Returns an interface to access the query plan cache for a collection. The interface provides methods to view and clear the query plan cache.
getShardDistribution                       Prints the data distribution statistics for a sharded collection.
getShardVersion                            Calls the getShardVersion command
hideIndex                                  Hides an existing index from the query planner.
initializeOrderedBulkOp                    Initializes an ordered bulk command. Returns an instance of Bulk
initializeUnorderedBulkOp                  Initializes an unordered bulk command. Returns an instance of Bulk
insert                                     Inserts a document or documents into a collection.
insertMany                                 Inserts multiple documents into a collection.
insertOne                                  Inserts a document into a collection.
isCapped                                   Checks if a collection is capped
latencyStats                               returns the $latencyStats aggregation for the collection. Takes an options document with an optional boolean 'histograms' field.
mapReduce                                  Calls the mapReduce command
reIndex                                    Rebuilds all existing indexes on a collection.
remove                                     Removes documents from a collection.
renameCollection                           Renames a collection.
replaceOne                                 Replaces a single document within the collection based on the filter.
runCommand                                 Runs a db command with the given name where the first param is the collection name.
stats                                      Returns statistics about the collection.
storageSize                                The total amount of storage allocated to this collection for document storage.
totalIndexSize                             Reports the total size used by the indexes on a collection.
totalSize                                  The total size in bytes of the data in the collection plus the size of every index on the collection.
unhideIndex                                Unhides an existing index from the query planner.
update                                     Modifies an existing document or documents in a collection.
updateMany                                 Updates all documents that match the specified filter for a collection.
updateOne                                  Updates a single document within the collection based on the filter.
validate                                   Calls the validate command. Default full value is false
watch                                      Opens a change stream cursor on the collection
</pre>
</div>
</div>
</div>

<div id="outline-container-org864313b" class="outline-3">
<h3 id="org864313b"><span class="section-number-3">2.4.</span> 客户端 (.NET MongoDB.Driver)</h3>
<div class="outline-text-3" id="text-2-4">
<p>
<a href="https://github.com/mongodb/mongo-csharp-driver">https://github.com/mongodb/mongo-csharp-driver</a>
</p>

<p>
首先，需要将数据库的驱动添加到项目中:
</p>
<pre class="example">
dotnet add package MongoDB.Driver
</pre>


<p>
然后，就可以使用了。
</p>

<p>
使用通用的 BsonDocument 表达数据:
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #005f5f;">var</span> <span style="color: #005e8b;">client</span> = <span style="color: #531ab6;">new</span> <span style="color: #005f5f;">MongoClient</span><span style="color: #000000;">(</span><span style="color: #3548cf;">"mongodb://localhost:27017"</span><span style="color: #000000;">)</span>;
<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">database</span> = client.<span style="color: #721045;">GetDatabase</span><span style="color: #000000;">(</span><span style="color: #3548cf;">"foo"</span><span style="color: #000000;">)</span>;
<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">collection</span> = database.<span style="color: #721045;">GetCollection</span><span style="color: #000000;">&lt;</span><span style="color: #005f5f;">BsonDocument</span><span style="color: #000000;">&gt;(</span><span style="color: #3548cf;">"bar"</span><span style="color: #000000;">)</span>;

<span style="color: #531ab6;">await</span> collection.<span style="color: #721045;">InsertOneAsync</span><span style="color: #000000;">(</span><span style="color: #531ab6;">new</span> <span style="color: #005f5f;">BsonDocument</span><span style="color: #dd22dd;">(</span><span style="color: #3548cf;">"Name"</span>, <span style="color: #3548cf;">"Jack"</span><span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span>;

<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">list</span> = <span style="color: #531ab6;">await</span> collection.<span style="color: #721045;">Find</span><span style="color: #000000;">(</span><span style="color: #531ab6;">new</span> <span style="color: #005f5f;">BsonDocument</span><span style="color: #dd22dd;">(</span><span style="color: #3548cf;">"Name"</span>, <span style="color: #3548cf;">"Jack"</span><span style="color: #dd22dd;">)</span><span style="color: #000000;">)</span>.<span style="color: #721045;">ToListAsync</span><span style="color: #000000;">()</span>;

<span style="color: #531ab6;">foreach</span><span style="color: #000000;">(</span><span style="color: #005f5f;">var</span> <span style="color: #005e8b;">document</span> <span style="color: #531ab6;">in</span> list<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Console.<span style="color: #721045;">WriteLine</span><span style="color: #dd22dd;">(</span>document<span style="color: #008899;">[</span><span style="color: #3548cf;">"Name"</span><span style="color: #008899;">]</span><span style="color: #dd22dd;">)</span>;
<span style="color: #000000;">}</span>
</pre>
</div>

<p>
使用强类型表达数据:
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #531ab6;">public</span> <span style="color: #531ab6;">class</span> <span style="color: #005f5f;">Person</span> <span style="color: #000000;">{</span> <span style="color: #531ab6;">public</span> <span style="color: #005f5f;">ObjectId</span> <span style="color: #005e8b;">Id</span> <span style="color: #dd22dd;">{</span> <span style="color: #531ab6;">get</span>; <span style="color: #531ab6;">set</span>; <span style="color: #dd22dd;">}</span> <span style="color: #531ab6;">public</span> <span style="color: #005f5f;">string</span> <span style="color: #005e8b;">Name</span> <span style="color: #dd22dd;">{</span> <span style="color: #531ab6;">get</span>; <span style="color: #531ab6;">set</span>; <span style="color: #dd22dd;">}</span> <span style="color: #000000;">}</span>

<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">client</span> = <span style="color: #531ab6;">new</span> <span style="color: #005f5f;">MongoClient</span><span style="color: #000000;">(</span><span style="color: #3548cf;">"mongodb://localhost:27017"</span><span style="color: #000000;">)</span>;
<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">database</span> = client.<span style="color: #721045;">GetDatabase</span><span style="color: #000000;">(</span><span style="color: #3548cf;">"foo"</span><span style="color: #000000;">)</span>;
<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">collection</span> = database.<span style="color: #721045;">GetCollection</span><span style="color: #000000;">&lt;</span><span style="color: #005f5f;">Person</span><span style="color: #000000;">&gt;(</span><span style="color: #3548cf;">"bar"</span><span style="color: #000000;">)</span>;

<span style="color: #531ab6;">await</span> collection.<span style="color: #721045;">InsertOneAsync</span><span style="color: #000000;">(</span><span style="color: #531ab6;">new</span> <span style="color: #005f5f;">Person</span> <span style="color: #dd22dd;">{</span> <span style="color: #005e8b;">Name</span> = <span style="color: #3548cf;">"Jack"</span> <span style="color: #dd22dd;">}</span><span style="color: #000000;">)</span>;

<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">list</span> = <span style="color: #531ab6;">await</span> collection.<span style="color: #721045;">Find</span><span style="color: #000000;">(</span>x =&gt; x.Name == <span style="color: #3548cf;">"Jack"</span><span style="color: #000000;">)</span>.<span style="color: #721045;">ToListAsync</span><span style="color: #000000;">()</span>;

<span style="color: #531ab6;">foreach</span><span style="color: #000000;">(</span><span style="color: #005f5f;">var</span> <span style="color: #005e8b;">person</span> <span style="color: #531ab6;">in</span> list<span style="color: #000000;">)</span>
<span style="color: #000000;">{</span>
    Console.<span style="color: #721045;">WriteLine</span><span style="color: #dd22dd;">(</span>person.Name<span style="color: #dd22dd;">)</span>;
<span style="color: #000000;">}</span>
</pre>
</div>

<p>
更多用法请参考官方文档: <br>
<a href="https://www.mongodb.com/docs/drivers/csharp/current/quick-start/">https://www.mongodb.com/docs/drivers/csharp/current/quick-start/</a>
</p>
</div>
</div>
</section>

<section id="outline-container-orga661eca" class="outline-2">
<h2 id="orga661eca"><span class="section-number-2">3.</span> Redis</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org619b46b" class="outline-3">
<h3 id="org619b46b"><span class="section-number-3">3.1.</span> 安装</h3>
<div class="outline-text-3" id="text-3-1">
<ul class="org-ul">
<li><a href="https://redis.io/download/">https://redis.io/download/</a></li>
<li><a href="https://github.com/tporadowski/redis">https://github.com/tporadowski/redis</a> (window native)</li>
</ul>
</div>
</div>

<div id="outline-container-org998bbb2" class="outline-3">
<h3 id="org998bbb2"><span class="section-number-3">3.2.</span> 服务端</h3>
<div class="outline-text-3" id="text-3-2">
<p>
要么通过服务，要么通过命令行:
</p>
<div class="org-src-container">
<pre class="src src-sh"><span style="color: #721045;">./redis-server</span> <span style="color: #000000;">(</span>run the server with default conf<span style="color: #000000;">)</span>
./redis-server /etc/redis/6379.conf
./redis-server --port 7777
./redis-server --port 7777 --replicaof 127.0.0.1 8888
./redis-server /etc/myredis.conf --loglevel verbose
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb6b537b" class="outline-3">
<h3 id="orgb6b537b"><span class="section-number-3">3.3.</span> 客户端 (redis-cli)</h3>
<div class="outline-text-3" id="text-3-3">
<p>
<a href="http://redisdoc.com/">http://redisdoc.com/</a>
</p>

<p>
基于 Key-Value 键值对的操作。
</p>
</div>
</div>

<div id="outline-container-orga58eb2e" class="outline-3">
<h3 id="orga58eb2e"><span class="section-number-3">3.4.</span> 客户端 (.NET)</h3>
<div class="outline-text-3" id="text-3-4">
<p>
安装驱动:
</p>
<pre class="example">
dotnet add package StackExchange.Redis
</pre>


<p>
代码示例：
</p>
<div class="org-src-container">
<pre class="src src-csharp"><span style="color: #005f5f;">ConnectionMultiplexer</span> <span style="color: #005e8b;">client</span> = ConnectionMultiplexer.<span style="color: #721045;">Connect</span><span style="color: #000000;">(</span><span style="color: #3548cf;">"localhost"</span><span style="color: #000000;">)</span>;
<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">db</span> = client.<span style="color: #721045;">GetDatabase</span><span style="color: #000000;">()</span>;
<span style="color: #005f5f;">var</span> <span style="color: #005e8b;">v</span> = db.<span style="color: #721045;">StringGet</span><span style="color: #000000;">(</span><span style="color: #3548cf;">"xxx"</span><span style="color: #000000;">)</span>;
db.<span style="color: #721045;">StringSet</span><span style="color: #000000;">(</span><span style="color: #3548cf;">"hello"</span>, <span style="color: #3548cf;">"world"</span><span style="color: #000000;">)</span>;
Console.<span style="color: #721045;">WriteLine</span><span style="color: #000000;">(</span>v<span style="color: #000000;">)</span>;
</pre>
</div>
</div>
</div>
</section>
</div>
<div id="postamble" class="status">
<p class="author">Author: 1a2y</p>
<p class="date">Created: 2023-02-16</p>
<p class="validation">Go ahead, never stop.</p>
</div>
</body>
</html>
